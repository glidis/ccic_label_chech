
# 客户标签测试组日志

## 11月底

修改从人前一层为“车+人”

## 12月3日

1. 总人数问题，反馈为
“我们在做宽表整合的时候是以其中某张结果表为主表的，我看了下我们的逻辑，应该是主表的选择有问题，我让开发的同事改一下。”

2. 整理从人指标的呈现方式（从人+车到人）

3. 人+车 => 从人汇总逻辑（暂不包含Ob和Ib）：  
  - 与报价有关的，选取最近一次报价对应信息，不考虑是否是最近一张保单对应的车。  
  - 与首次有关的，直接选取首次相关信息，不考虑车的问题。  
  - 历史有关的，分两种:   
     + 平均值字段，对各车的平均值进行加权求和。权重为各车的指标个数/人的指标总数。
     + 总量字段，sum即可

## 12月4日
ob中找到报价单号，进而找到保单号关联
报价单中的policyno：Tabccarinsurance.policyno
和objective 关联  a.customer_guid=b.customer_guid
姚老师代码中的可用，注意多对多的情况产生笛卡尔积

## 2019-01-08

spark-shell中udf函数注意事项：  
  - null值需要有对应的处理方式。例如
  def foo(bar: String): String = {
  var values = ""
  values = bar.replace("\\s", "")
  return(values)}